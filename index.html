<!DOCTYPE html>
<!-- index.html -->
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="SortierenV2">
  <link rel="apple-touch-icon" href="icon.png">
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#2196f3">
  <link rel="apple-touch-icon" href="icons/icon-192.png">
</head>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Budget Manager</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <!-- Header mit Titel und Einstellungen-Icon -->
  <div id="header">
    <h1>Budget Manager</h1>
    
    <div id="settings-icon" title="Einstellungen">&#9776;</div>
  </div>

   <!-- ================= POPUP: Einstellungen ================= -->
  <div id="popup2-overlay">
    <div id="popup2">
      <button id="popup2-close">&times;</button>
      <h2>Einstellungen</h2>
      <p>Hier kannst du deine Einstellungen anpassen.</p>
      <button id="open-kategorie-popup" style="margin-top: 20px;">Kategorien verwalten</button>
      <button id="open-budget-popup" style="margin-top: 20px;">Budget verwalten</button>
      <button id="open-wiederkehrende-popup" style="margin-top: 20px;">Wiederkehrende Zahlungen</button>

    </div>

  <!-- ================= POPUP: Kategorien-Verwaltung ================= -->
    <!-- Kategorien-Verwaltungs-Popup -->
<div id="kategorie-popup-overlay" style="
  display: none;
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.5);
  justify-content: center;
  align-items: center;
  z-index: 1100;
">
  <div id="kategorie-popup" style="
    background: white;
    padding: 20px;
    border-radius: 10px;
    max-width: 400px;
    width: 90%;
    position: relative;
  ">
    <button id="kategorie-popup-close" style="
      position: absolute;
      top: 10px;
      right: 10px;
      font-size: 1.5rem;
      cursor: pointer;
      border: none;
      background: transparent;
    ">&times;</button>

    <h3>Kategorien verwalten</h3>
    <label for="typ-auswahl">Typ:</label>
    <select id="typ-auswahl">
      <option value="einnahme">Einzahlung</option>
      <option value="ausgabe">Auszahlung</option>
    </select>
    <!-- <input type="text" id="neue-kategorie" placeholder="Neue Kategorie..." />
    <button id="hinzufuegen-kategorie">Hinzuf√ºgen</button>-->
    <input type="text" id="wordInput" placeholder="Wort eingeben">
  <button onclick="addWord()">Hinzuf√ºgen</button>

    <ul id="kategorie-liste" style="margin-top: 20px; list-style: none; padding-left: 0;"></ul>
  </div>
</div>

<!-- ================= POPUP: Budget-Verwaltung ================= -->
<!-- Budget-Verwaltungs-Popup -->
 <!-- Budget Popup -->
<div id="budget-popup-overlay" class="overlay hidden">
  <div id="budget-popup" class="popup">
    <button class="close-btn" id="budget-close">&times;</button>
    <h2>Budget festlegen</h2>
    <p>Gib hier dein monatliches Budget ein:</p>
    <input type="number" id="budget-input" placeholder="z.‚ÄØB. 1500 ‚Ç¨" />
    <div class="budget-buttons">
      <button id="save-budget">Speichern</button>
      <button id="clear-budget">L√∂schen</button>
    </div>
  </div>
</div>
<!-- Budget-Verwaltungs Popup Ende -->

  </div>

  <script>
    // Auslagerung 1.1
    // Auslagerung 1.2
  </script>


<!-- ================= Tabs f√ºr Navigation ================= -->
  <!-- Tabs -->
  <div id="tabs">
    <button id="tab-kalender" class="active">üìÖ Kalender</button>
    <button id="tab-statistik">üìä Statistik</button>
  </div>

   <!-- ================= Tab-Inhalte ================= -->
  <div id="tab-content">
    <!-- ========== Kalender-Tab ========== -->
    <!-- Kalender Tab -->
    <div id="tab-content-kalender" class="active">
      <form id="form">
        
        <input type="date" id="datum" required style="display:none;" />

        <!--<button type="submit">Hinzuf√ºgen</button> -->
      </form>


      <!-- ================= Monates√ºbersicht ================= -->
      <!-- F√ºr Monates√ºbersicht welche Ein-Ausgaben + Budget oben auf Titelseite -->
<!-- Monats√ºbersicht -->
<div id="monatsuebersicht">
  <div class="uebersicht-feld einnahmen">Einnahmen:<br><span id="monat-einnahmen">0.00 ‚Ç¨</span></div>
  <div class="uebersicht-feld budget">Budget:<br><span id="monat-budget">0.00 ‚Ç¨</span></div>
  <div class="uebersicht-feld ausgaben">Ausgaben:<br><span id="monat-ausgaben">0.00 ‚Ç¨</span></div>
</div>
<!-- Budget-Slider -->
<div id="budget-progress-container">
  <div id="budget-bar-background">
    <div id="budget-bar-fill"></div>
    <div id="budget-time-marker"></div>
  </div>
  <div id="budget-stand-text"></div>
</div>


<!-- Ende F√ºr Monates√ºbersicht welche Ein-Ausgaben + Budget oben auf Titelseite -->

      <div id="monatsteuerelemente">
        <button id="vorherigerMonat">&lt; Vorheriger Monat</button>
        <div id="monatanzeige"></div>
        <button id="naechsterMonat">N√§chster Monat &gt;</button>
      </div>

      <div id="kalender"></div>

      <h2>Eintr√§ge f√ºr ausgew√§hlten Tag</h2>
      <ul id="liste"></ul>
    </div>

    <!-- ========== Statistik-Tab ========== -->
    <div id="tab-content-statistik">
      <h2>Statistik</h2>

      <!-- Monatsselect Statistik oben -->
      <div id="monatsteuerelemente">
        <button id="vorherigerMonat">&lt; Vorheriger Monat</button>
        <div id="monatanzeige"></div>
        <button id="naechsterMonat">N√§chster Monat &gt;</button>
      </div>
      <!-- Monatsselect Statistik oben Ende -->

      <!-- Slider Ein- Ausgaben -->
      <div class="container">
  <div class="nav" id="nav">
    <div data-pos="0">Einnahmen</div>
    <div data-pos="1">Budget</div>
    <div data-pos="2">Ausgaben</div>
    <div class="underline"></div>
  </div>
</div>
<script>
  const nav = document.getElementById('nav');
  const underline = nav.querySelector('.underline');
  const items = nav.querySelectorAll('div[data-pos]');
  
  items.forEach(item => {
    item.addEventListener('click', () => {
      const pos = parseInt(item.getAttribute('data-pos'));
      underline.style.left = (pos * 33.3333) + '%';
    });
  });
</script>
      <!-- Slider Ein- Ausgaben Ende -->
     

      <!-- Chart Tab2 Start-->
      <canvas id="chart" width="700" height="300" style="border:1px solid #ccc; border-radius:6px;"></canvas>
    </div>
  </div>
  <!-- Chart Tab2 Ende-->

<!-- ================= PLUS-BUTTON & Formular f√ºr Eintrag ================= -->
<button id="plus-button">+</button>

  <!-- Popup-Overlay hinter plus button-->
  <div id="popup-overlay">
    <div id="popup">
      <button id="popup-close">&times;</button>
      <h2>Neuer Eintrag</h2>

      <!-- Buttons f√ºr Typ -->
      <div id="typ-buttons">
        <button type="button" class="typ-btn" data-typ="einnahme">Einzahlung</button>
        <button type="button" class="typ-btn" data-typ="ausgabe">Auszahlung</button>
      </div>

      <!-- Formular -->
<form id="popup-form">
  <input type="hidden" id="popup-typ" name="typ" required />

  <table>
    <tr>
      <td><label for="popup-betrag">Betrag:</label></td>
    </tr>
    <tr>
      <td>
        <input type="number" id="popup-betrag" name="betrag" placeholder="Betrag (‚Ç¨)" step="0.01" min="0" required />
      </td>
    </tr>

    <tr>
      <td><label for="wordSelect">Kategorie:</label></td>
    </tr>
    <tr>
      <td>
        <select id="wordSelect">
          <option disabled selected>Keine W√∂rter verf√ºgbar</option>
        </select>
      </td>
    </tr>

    <tr>
      <td><label for="popup-datum">Datum:</label></td>
    </tr>
    <tr>
      <td><input type="date" id="popup-datum" name="datum" required /></td>
    </tr>
  </table>

  <button type="submit">Hinzuf√ºgen</button>
</form>


<!-- ================= SCRIPTS ================= -->
<!-- JavaScript -->
 <!-- Plus-Button Popup Logik -->
<script>
document.getElementById('plus-button').addEventListener('click', () => {
  document.getElementById('popup-overlay').style.display = 'flex';

  // Standard-Typ setzen (z.B. "einnahme")
  const defaultTyp = 'einnahme';
  document.getElementById('popup-typ').value = defaultTyp;

  // Aktive Klasse setzen (optional f√ºr CSS-Styling)
  document.querySelectorAll('.typ-btn').forEach(btn => {
    btn.classList.toggle('active', btn.dataset.typ === defaultTyp);
  });

  // Kategorien-Dropdown sofort aktualisieren
  updateSelect();
});
</script>
<!-- Plus-Button Popup Logik Ende -->

<script>
  const words = [];
</script>

<script>
document.querySelectorAll('.typ-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    const typ = btn.getAttribute('data-typ');
    document.getElementById('popup-typ').value = typ;
    updateSelect(); // ‚úÖ aktualisiert sofort die Kategorienliste
  });
});



  let kategorien = {
  einnahme: [],
  ausgabe: []
};

// Beim Laden die Kategorien aus localStorage wiederherstellen
const gespeicherteKategorien = localStorage.getItem('kategorien');
if (gespeicherteKategorien) {
  try {
    kategorien = JSON.parse(gespeicherteKategorien);
  } catch (e) {
    console.error('Fehler beim Parsen gespeicherter Kategorien:', e);
  }
}
// Beim Laden die Kategorien aus localStorage wiederherstellen Ende


  function updateSelect() {
  const select = document.getElementById('wordSelect');
  const typ = document.getElementById('popup-typ').value;
  select.innerHTML = '';

  const kategorieListe = kategorien[typ] || [];

  if (kategorieListe.length === 0) {
    const option = document.createElement('option');
    option.text = 'Keine Kategorien verf√ºgbar';
    option.disabled = true;
    option.selected = true;
    select.add(option);
    return;
  }

  kategorieListe.forEach(word => {
    const option = document.createElement('option');
    option.text = word;
    select.add(option);
  });
}

  function addWord() {
  const input = document.getElementById('wordInput');
  const typAuswahl = document.getElementById('typ-auswahl');
  const typ = typAuswahl.value;
  const word = input.value.trim();

  if (word && !kategorien[typ].includes(word)) {
    kategorien[typ].push(word);

    // ‚úÖ Kategorien speichern
    localStorage.setItem('kategorien', JSON.stringify(kategorien));

    input.value = '';
    updateKategorieListe();

    if (document.getElementById('popup-typ').value === typ) {
      updateSelect();
    }
  }
}

  function updateKategorieListe() {
  const ul = document.getElementById('kategorie-liste');
  const typ = document.getElementById('typ-auswahl').value;
  ul.innerHTML = '';

  kategorien[typ].forEach((word, index) => {
    const li = document.createElement('li');
    li.style.display = 'flex';
    li.style.justifyContent = 'space-between';
    li.style.alignItems = 'center';

    const text = document.createElement('span');
    text.textContent = word;

    const loeschenBtn = document.createElement('button');
    loeschenBtn.textContent = '‚ùå';
    loeschenBtn.style.marginLeft = '10px';
    loeschenBtn.style.cursor = 'pointer';
    loeschenBtn.style.border = 'none';
    loeschenBtn.style.background = 'transparent';
    loeschenBtn.style.color = 'red';

    loeschenBtn.addEventListener('click', () => {
      kategorien[typ].splice(index, 1);
      localStorage.setItem('kategorien', JSON.stringify(kategorien));
      updateKategorieListe();
      // Wenn im Popup1 dieselbe Kategoriegruppe aktiv ist, Liste auch dort aktualisieren
      if (document.getElementById('popup-typ').value === typ) {
        updateSelect();
      }
    });

    li.appendChild(text);
    li.appendChild(loeschenBtn);
    ul.appendChild(li);
  });
}


  document.getElementById('typ-auswahl').addEventListener('change', () => {
    updateKategorieListe();
  });

  
</script>





<!-- Popup-Overlay fertig -->

<!-- Popup2 f√ºr Einstellungen -->
<!-- Popup2 f√ºr Einstellungen -->


<div id="popup2-overlay" style="
  display: none;
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.5);
  justify-content: center;
  align-items: center;
  z-index: 1000;
">
  <div id="popup2" style="
    background: white;
    padding: 20px;
    border-radius: 10px;
    max-width: 400px;
    width: 90%;
    position: relative;
  ">
    <button id="popup2-close" style="
      position: absolute;
      top: 10px;
      right: 10px;
      font-size: 1.5rem;
      cursor: pointer;
      border: none;
      background: transparent;
    ">&times;</button>
    <h2>Einstellungen</h2>
    <p>Hier kannst du deine Einstellungen anpassen.</p>
     <!-- F√ºge hier deine Einstellungsfelder hinzu -->
      <!-- Einstellungsfeld f√ºr dynamische Kategorien -->
<hr style="margin: 20px 0;" />
<h3>Kategorien verwalten</h3>

<label for="typ-auswahl">Typ:</label>
<select id="typ-auswahl" style="margin-bottom: 10px;">
  <option value="einnahme">Einzahlung</option>
  <option value="ausgabe">Auszahlung</option>
</select>

<br />

<input type="text" id="neue-kategorie" placeholder="Neue Kategorie..." />
<button id="hinzufuegen-kategorie">Hinzuf√ºgen</button>

<ul id="kategorie-liste" style="margin-top: 20px; list-style: none; padding-left: 0;"></ul>
<!-- Einstellungsfeld f√ºr dynamische Kategorien Ende -->


  </div>
</div>

<!--  Auslagerung 1.3 -->

<!-- Popup2 f√ºr Einstellungen fertig -->

<!-- Hilfsfunktion f√ºr Budget aktuallisieren -->
 <script>
  function berechneMonatsuebersicht(jahr, monat) {
  let einnahmen = 0;
  let ausgaben = 0;

  // Einnahmen und Ausgaben berechnen
  alleEintraege.forEach(eintrag => {
    const eintragsDatum = new Date(eintrag.datum);
    if (
      eintragsDatum.getFullYear() === jahr &&
      eintragsDatum.getMonth() === monat
    ) {
      if (eintrag.typ === "einnahme") {
        einnahmen += eintrag.betrag;
      } else if (eintrag.typ === "ausgabe") {
        ausgaben += eintrag.betrag;
      }
    }
  });

  const budget = einnahmen - ausgaben;

  // DOM-Elemente holen
  const einnahmenElement = document.getElementById("monat-einnahmen");
  const ausgabenElement = document.getElementById("monat-ausgaben");
  const budgetElement = document.getElementById("monat-budget");

  // Werte aktualisieren
  einnahmenElement.textContent = `${einnahmen.toFixed(2)} ‚Ç¨`;
  ausgabenElement.textContent = `${ausgaben.toFixed(2)} ‚Ç¨`;
  budgetElement.textContent = `${budget.toFixed(2)} ‚Ç¨`;

  // Klassen dynamisch setzen f√ºr Farbe
  budgetElement.classList.remove("positiv", "negativ");
  if (budget >= 0) {
    budgetElement.classList.add("positiv");  // blau (CSS siehe unten)
  } else {
    budgetElement.classList.add("negativ");  // rot
  }
}

</script>

<script>
// ------------------ Auslagerung 1.1 -- Einstellungen-Popup anzeigen
document.addEventListener("DOMContentLoaded", () => {
  const settingsIcon = document.getElementById("settings-icon");
  const popup2Overlay = document.getElementById("popup2-overlay");
  const popup2Close = document.getElementById("popup2-close");
  document.getElementById('typ-auswahl').dispatchEvent(new Event('change'));

  if (settingsIcon && popup2Overlay && popup2Close) {
    settingsIcon.addEventListener("click", () => {
      popup2Overlay.style.display = "flex";
    });

    popup2Close.addEventListener("click", () => {
      popup2Overlay.style.display = "none";
    });

    popup2Overlay.addEventListener("click", (event) => {
      if (event.target === popup2Overlay) {
        popup2Overlay.style.display = "none";
      }
    });
  }
});
// Auslagerung 1.1 Ende
// --------------------- Auslagerung 1.2 Start --- Popup zum Verwalten der Kategorien
 // was steht in dem Popup "Kategorien Verwalten in den Einstellungen" Start
const openKategoriePopupBtn = document.getElementById("open-kategorie-popup");
const kategoriePopupOverlay = document.getElementById("kategorie-popup-overlay");
const kategoriePopupClose = document.getElementById("kategorie-popup-close");

if (openKategoriePopupBtn && kategoriePopupOverlay && kategoriePopupClose) {
  openKategoriePopupBtn.addEventListener("click", () => {
    kategoriePopupOverlay.style.display = "flex";
  });

  kategoriePopupClose.addEventListener("click", () => {
    kategoriePopupOverlay.style.display = "none";
  });

  kategoriePopupOverlay.addEventListener("click", (event) => {
    if (event.target === kategoriePopupOverlay) {
      kategoriePopupOverlay.style.display = "none";
    }
  });
}
// was steht in dem Popup "Kategorien Verwalten in den Einstellungen" Ende
// Auslagerung 1.2 Ende

// ------------------- Auslagerung 1.3 Start --- Formular im Popup: Eintrag hinzuf√ºgen
document.getElementById('popup-form').addEventListener('submit', function (e) {
  e.preventDefault();

  const typ = document.getElementById('popup-typ').value;
  const betrag = parseFloat(document.getElementById('popup-betrag').value);
  const kategorie = document.getElementById('wordSelect').value;
  const datum = document.getElementById('popup-datum').value;

  if (!typ || isNaN(betrag) || !kategorie || !datum) {
    alert('Bitte alle Felder korrekt ausf√ºllen!');
    return;
  }

  const eintrag = { typ, betrag, kategorie, datum };

  let eintraege = JSON.parse(localStorage.getItem('eintraege')) || [];
  eintraege.push(eintrag);
  localStorage.setItem('eintraege', JSON.stringify(eintraege));
  berechneMonatsuebersicht(aktuellesDatum.getFullYear(), aktuellesDatum.getMonth());


  // ‚úÖ Kalender aktualisieren
  if (typeof renderKalender === 'function') {
    renderKalender();
  } else {
    console.warn("renderKalender-Funktion nicht gefunden.");
  }
  // ‚úÖ Liste aktualisieren
  if (typeof renderListe === 'function') {
    renderListe();
  } else {
    console.warn("renderListe-Funktion nicht gefunden.");
  }
   // üëâ Monats√ºbersicht mit aktualisiertem Budget neu berechnen
  const heute = new Date();
  berechneMonatsuebersicht(heute.getFullYear(), heute.getMonth());

  // ‚úÖ Tageseintr√§ge aktualisieren, falls vorhanden
  if (typeof zeigeEintraegeProTag === 'function') {
    zeigeEintraegeProTag(datum);
  }

  // Formular zur√ºcksetzen & Popup schlie√üen
  document.getElementById('popup-form').reset();
  document.getElementById('popup-overlay').style.display = 'none';
});

// Auslagerung 1.3 Ende



// --------------------------------- TAB SWITCHING ---
  const tabKalenderBtn = document.getElementById("tab-kalender");
  const tabStatistikBtn = document.getElementById("tab-statistik");
  const tabKalenderContent = document.getElementById("tab-content-kalender");
  const tabStatistikContent = document.getElementById("tab-content-statistik");

  tabKalenderBtn.addEventListener("click", () => {
    tabKalenderBtn.classList.add("active");
    tabStatistikBtn.classList.remove("active");
    tabKalenderContent.classList.add("active");
    tabStatistikContent.classList.remove("active");
  });
  tabStatistikBtn.addEventListener("click", () => {
    tabKalenderBtn.classList.remove("active");
    tabStatistikBtn.classList.add("active");
    tabKalenderContent.classList.remove("active");
    tabStatistikContent.classList.add("active");
    zeichneStatistik();
  });

  // --- DATEN ---
  let eintraege = JSON.parse(localStorage.getItem("eintraege") || "[]");

  // Hilfsfunktion: Datum in YYYY-MM-DD String
  function formatDate(date) {
  const jahr = date.getFullYear();
  const monat = String(date.getMonth() + 1).padStart(2, '0');
  const tag = String(date.getDate()).padStart(2, '0');
  return `${jahr}-${monat}-${tag}`;
}


  // Aktueller angezeigter Monat
  let aktuellesDatum = new Date();
  aktuellesDatum.setDate(1);

  // Ausgew√§hltes Datum im Kalender (Standard: heute)
  let ausgewaehltesDatum = formatDate(new Date());

  // DOM-Elemente
  const kalender = document.getElementById("kalender");
  const monatanzeige = document.getElementById("monatanzeige");
  const vorherigerMonatBtn = document.getElementById("vorherigerMonat");
  const naechsterMonatBtn = document.getElementById("naechsterMonat");
  const liste = document.getElementById("liste");
  const form = document.getElementById("form");
  const formTypInput = document.getElementById("typ");
  const betragInput = document.getElementById("betrag");
  const kategorieInput = document.getElementById("kategorie");
  const datumInput = document.getElementById("datum");

  // Monatsanzeige formatieren
  function zeigeMonat() {
    const options = { year: "numeric", month: "long" };
    monatanzeige.textContent = aktuellesDatum.toLocaleDateString("de-DE", options);
  }

  // Kalender rendern / Kalender generieren & darstellen
  function renderKalender() {
    kalender.innerHTML = "";
    zeigeMonat();

    const jahr = aktuellesDatum.getFullYear();
    const monat = aktuellesDatum.getMonth();

    // Erster Tag des Monats (Wochentag: 0=Sonntag)
    const ersterWochentag = new Date(jahr, monat, 1).getDay();
    // Umrechnung auf Montag=0
    const startIndex = (ersterWochentag + 6) % 7;

    // Anzahl Tage im Monat
    const tageImMonat = new Date(jahr, monat + 1, 0).getDate();

    // Leerfelder vor Monatsbeginn
    for(let i = 0; i < startIndex; i++) {
      const leer = document.createElement("div");
      leer.className = "leer";
      kalender.appendChild(leer);
    }

    // Heute zum Vergleich
    const heuteStr = formatDate(new Date());

    // Tage rendern
    for(let tag=1; tag <= tageImMonat; tag++) {
      const tagDiv = document.createElement("div");
      tagDiv.className = "tag";
      const tagDatum = new Date(jahr, monat, tag);
      const tagDatumStr = formatDate(tagDatum);

      // Tagnummer anzeigen
      tagDiv.textContent = tag;

      // Markiere heute
      if(tagDatumStr === heuteStr) {
        tagDiv.classList.add("heute");
      }
      // Markiere ausgew√§hlten Tag
      if(tagDatumStr === ausgewaehltesDatum) {
        tagDiv.classList.add("ausgewaehlt");
      }

      // Saldo f√ºr Tag berechnen
      const saldo = berechneSaldoFuerDatum(tagDatumStr);
      if(saldo !== 0) {
        const saldoSpan = document.createElement("span");
        saldoSpan.className = "saldo " + (saldo > 0 ? "positiv" : "negativ");
        saldoSpan.textContent = (saldo > 0 ? "+" : "") + saldo.toFixed(2) + " ‚Ç¨";
        tagDiv.appendChild(document.createElement("br"));
        tagDiv.appendChild(saldoSpan);
      }

      // Klick auf Tag: ausw√§hlbar
tagDiv.addEventListener("click", () => {
  ausgewaehltesDatum = tagDatumStr;
  renderKalender();
  renderListe();

  // NEU: Datum in beide Formulare eintragen
  datumInput.value = ausgewaehltesDatum;
  popupDatum.value = ausgewaehltesDatum;

  

});



      kalender.appendChild(tagDiv);
    }

      // Leerfelder nach Monatsende, damit Raster vollst√§ndig ist (7 Spalten)
  const gesamtFelder = startIndex + tageImMonat;
  const restFelder = gesamtFelder % 7 === 0 ? 0 : 7 - (gesamtFelder % 7);
  for(let i=0; i < restFelder; i++) {
    const leer = document.createElement("div");
    leer.className = "leer";
    kalender.appendChild(leer);
  }

  // üü¢ Monats√ºbersicht aktualisieren
  berechneMonatsuebersicht(jahr, monat);
}


  // Saldo f√ºr Datum (Einnahmen - Ausgaben)
  function berechneSaldoFuerDatum(datumStr) {
  const eintraege = JSON.parse(localStorage.getItem('eintraege')) || [];
  let saldo = 0;

  eintraege.forEach(eintrag => {
    if (eintrag.datum === datumStr) {
      if (eintrag.typ === "einnahme") {
        saldo += parseFloat(eintrag.betrag);
      } else if (eintrag.typ === "ausgabe") {
        saldo -= parseFloat(eintrag.betrag);
      }
    }
  });

  return saldo;
}

function ladeEintraege() {
  const gespeicherte = localStorage.getItem('eintraege');
  return gespeicherte ? JSON.parse(gespeicherte) : [];
}

  // Liste der Eintr√§ge f√ºr ausgew√§hlten Tag rendern
  function renderListe() {
  liste.innerHTML = "";

  const eintraege = ladeEintraege();

  const gefilterte = eintraege.filter(e => e.datum === ausgewaehltesDatum);

  if (gefilterte.length === 0) {
    const li = document.createElement("li");
    li.textContent = "Keine Eintr√§ge f√ºr diesen Tag.";
    liste.appendChild(li);
    return;
  }

  gefilterte.forEach((eintrag, indexGefiltert) => {
    const li = document.createElement("li");

    const text = `${eintrag.typ === "einnahme" ? "+" : "-"}${eintrag.betrag.toFixed(2)} ‚Ç¨ ‚Äî ${eintrag.kategorie}`;
    const spanText = document.createElement("span");
    spanText.textContent = text;
    spanText.style.color = eintrag.typ === "einnahme" ? "green" : "red";

    const loeschBtn = document.createElement("button");
    loeschBtn.textContent = "X";
    loeschBtn.title = "Eintrag l√∂schen";

    loeschBtn.addEventListener("click", () => {
  if (confirm("M√∂chten Sie diesen Eintrag wirklich l√∂schen?")) {
    const alleEintraege = ladeEintraege();
    const indexOriginal = alleEintraege.findIndex(e => 
      e.typ === eintrag.typ &&
      e.betrag === eintrag.betrag &&
      e.kategorie === eintrag.kategorie &&
      e.datum === eintrag.datum
    );

    if (indexOriginal !== -1) {
      alleEintraege.splice(indexOriginal, 1);
      localStorage.setItem('eintraege', JSON.stringify(alleEintraege));
      berechneMonatsuebersicht(aktuellesDatum.getFullYear(), aktuellesDatum.getMonth()); // neu
      renderKalender();
      renderListe();
    }
  }
});

    li.appendChild(spanText);
    li.appendChild(loeschBtn);
    liste.appendChild(li);
  });
}



  // Eintr√§ge in localStorage speichern
  function speichereEintraege() {
    localStorage.setItem("eintraege", JSON.stringify(eintraege));
  }
  berechneMonatsuebersicht(aktuellesDatum.getFullYear(), aktuellesDatum.getMonth());

  renderKalender();
renderListe(); // aktualisiert Liste sofort

  // Formular absenden: neuen Eintrag hinzuf√ºgen
  form.addEventListener("submit", (e) => {
    e.preventDefault();

    const typ = formTypInput.value;
    const betrag = parseFloat(betragInput.value);
    const kategorie = kategorieInput.value;
    const datum = datumInput.value;

    if (!datum) {
      alert("Bitte ein g√ºltiges Datum eingeben.");
      return;
    }
    if (isNaN(betrag) || betrag <= 0) {
      alert("Bitte einen g√ºltigen Betrag gr√∂√üer 0 eingeben.");
      return;
    }

    eintraege.push({ typ, betrag, kategorie, datum });
    speichereEintraege();
    berechneMonatsuebersicht(aktuellesDatum.getFullYear(), aktuellesDatum.getMonth());

    

    // Wenn Eintrag f√ºr aktuellen Monat/datum, Kalender + Liste updaten
    if (datum.startsWith(aktuellesDatum.getFullYear() + "-" + String(aktuellesDatum.getMonth() + 1).padStart(2, "0"))) {
      renderKalender();
    }

    if (datum === ausgewaehltesDatum) {
      renderListe();
    }

    // Formular zur√ºcksetzen
    form.reset();

    // Datum im Formular auf aktuell ausgew√§hltes Datum setzen
    datumInput.value = ausgewaehltesDatum;
  });

  // Monatsnavigation
  vorherigerMonatBtn.addEventListener("click", () => {
    aktuellesDatum.setMonth(aktuellesDatum.getMonth() - 1);
    renderKalender();
    // Nach Monatswechsel ggf. ausgew√§hltes Datum anpassen:
    if (!ausgewaehltesDatum.startsWith(aktuellesDatum.getFullYear() + "-" + String(aktuellesDatum.getMonth() + 1).padStart(2, "0"))) {
      ausgewaehltesDatum = formatDate(aktuellesDatum);
      renderListe();
    }
  });
  naechsterMonatBtn.addEventListener("click", () => {
    aktuellesDatum.setMonth(aktuellesDatum.getMonth() + 1);
    renderKalender();
    if (!ausgewaehltesDatum.startsWith(aktuellesDatum.getFullYear() + "-" + String(aktuellesDatum.getMonth() + 1).padStart(2, "0"))) {
      ausgewaehltesDatum = formatDate(aktuellesDatum);
      renderListe();
    }
  });

  // Formular-Datum initial auf heute
  datumInput.value = ausgewaehltesDatum;

  // STATISTIK: Balkendiagramm mit Canvas
  function zeichneStatistik() {
    const canvas = document.getElementById("chart");
    const ctx = canvas.getContext("2d");

    // Kategorien summieren (Saldo)
    const saldoProKategorie = {};
    eintraege.forEach(eintrag => {
      const k = eintrag.kategorie;
      if (!saldoProKategorie[k]) saldoProKategorie[k] = 0;
      saldoProKategorie[k] += (eintrag.typ === "einnahme" ? 1 : -1) * eintrag.betrag;
    });

    // Daten vorbereiten
    const kategorien = Object.keys(saldoProKategorie);
    const werte = kategorien.map(k => saldoProKategorie[k]);

    // Canvas clear
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    if (kategorien.length === 0) {
      ctx.font = "16px Arial";
      ctx.fillText("Keine Daten f√ºr Statistik", 10, 50);
      return;
    }

    // Balkendiagramm Parameter
    const padding = 50;
    const balkenBreite = 40;
    const maxWert = Math.max(...werte.map(v => Math.abs(v)));

    // Y-Achse skalieren (bis maxWert + etwas Puffer)
    const maxY = maxWert * 1.1;

    // Achsen zeichnen
    ctx.strokeStyle = "#333";
    ctx.lineWidth = 1;
    ctx.beginPath();
    // Y-Achse
    ctx.moveTo(padding, padding / 2);
    ctx.lineTo(padding, canvas.height - padding);
    // X-Achse
    ctx.lineTo(canvas.width - padding / 2, canvas.height - padding);
    ctx.stroke();

    // Y-Achsen Werte + Linien (5 Schritte)
    ctx.fillStyle = "#333";
    ctx.font = "12px Arial";
    ctx.textAlign = "right";
    for (let i = 0; i <= 5; i++) {
      const y = padding + ((canvas.height - 2 * padding) / 5) * i;
      const wert = maxY - (maxY / 5) * i;
      ctx.fillText(wert.toFixed(2) + "‚Ç¨", padding - 10, y + 4);

      // Hilfslinien
      ctx.strokeStyle = "#ddd";
      ctx.beginPath();
      ctx.moveTo(padding, y);
      ctx.lineTo(canvas.width - padding / 2, y);
      ctx.stroke();
    }

    // Balken zeichnen
    ctx.textAlign = "center";
    kategorien.forEach((kategorie, i) => {
      const wert = werte[i];
      const x = padding + 60 + i * (balkenBreite + 20);
      const yNull = canvas.height - padding;
      const balkenHoehe = (wert / maxY) * (canvas.height - 2 * padding);

      // Balkenfarbe gr√ºn bei positiv, rot bei negativ
      ctx.fillStyle = wert >= 0 ? "green" : "red";
      ctx.fillRect(x, yNull - Math.max(0, balkenHoehe), balkenBreite, Math.abs(balkenHoehe));

      // Kategorie unter Balken
      ctx.fillStyle = "#000";
      ctx.font = "14px Arial";
      ctx.fillText(kategorie, x + balkenBreite / 2, yNull + 15);

      // Wert √ºber Balken
      ctx.fillText(wert.toFixed(2) + "‚Ç¨", x + balkenBreite / 2, yNull - Math.abs(balkenHoehe) - 5);
    });
  }

  // Initial rendern
  renderKalender();
  renderListe();

  // Plus-Button & Popup
const plusButton = document.getElementById("plus-button");
const popupOverlay = document.getElementById("popup-overlay");
const popupClose = document.getElementById("popup-close");

plusButton.addEventListener("click", () => {
  popupDatum.value = ausgewaehltesDatum;
  popupOverlay.style.display = "flex";

  // Standardm√§√üig "Ausgabe" ausw√§hlen
  typButtons[1].click(); // Simuliert echten Klick ‚Üí triggert komplette Logik inkl. Kategorie-Update

});



popupClose.addEventListener("click", () => {
  popupOverlay.style.display = "none";
});
  // Popup command ende (schlie√üen, wenn au√üerhalb geklickt)

// --- POPUP-FORMULAR VERARBEITEN ---
const popupForm = document.getElementById("popup-form");
const popupTyp = document.getElementById("popup-typ");
const popupBetrag = document.getElementById("popup-betrag");
const popupKategorie = document.getElementById("popup-kategorie");
const popupDatum = document.getElementById("popup-datum");

popupForm.addEventListener("submit", (e) => {
  e.preventDefault();

  const typ = popupTyp.value;
  const betrag = parseFloat(popupBetrag.value);
  const kategorie = popupKategorie.value;
  const datum = popupDatum.value;

  if (!datum) {
    alert("Bitte ein g√ºltiges Datum eingeben.");
    return;
  }
  if (isNaN(betrag) || betrag <= 0) {
    alert("Bitte einen g√ºltigen Betrag gr√∂√üer 0 eingeben.");
    return;
  }

  eintraege.push({ typ, betrag, kategorie, datum });
  speichereEintraege();
  berechneMonatsuebersicht(aktuellesDatum.getFullYear(), aktuellesDatum.getMonth());

  if (datum.startsWith(aktuellesDatum.getFullYear() + "-" + String(aktuellesDatum.getMonth() + 1).padStart(2, "0"))) {
    renderKalender();
  }

  if (datum === ausgewaehltesDatum) {
    renderListe();
  }

  popupForm.reset();
  popupOverlay.style.display = "none";
});

// Popup schlie√üen, wenn au√üerhalb geklickt
popupOverlay.addEventListener("click", (e) => {
  if (e.target === popupOverlay) {
    popupOverlay.style.display = "none";
  }
});
// --- fertig Popup ---
// --- fertig Popup ---


// --- Typ-Button-Auswahl (Einzahlung/Auszahlung) ---
const typButtons = document.querySelectorAll('.typ-btn');
const typInput = document.getElementById('popup-typ');

const einnahmeKategorien = ["Besoldung", "Eltern Zuschuss", "Zinsen TR"];
const ausgabeKategorien = ["Einkauf", "Transport", "Freizeit", "B√ºro", "Urlaub", "Gehalt", "Sonstiges"];

function aktualisiereKategorien(kategorien) {
  popupKategorie.innerHTML = '<option value="">-- W√§hlen --</option>';
  kategorien.forEach(kat => {
    const option = document.createElement("option");
    option.textContent = kat;
    option.value = kat;
    popupKategorie.appendChild(option);
  });
}

typButtons.forEach(btn => {
  btn.addEventListener('click', () => {
    // Alle Buttons zur√ºcksetzen
    typButtons.forEach(b => b.classList.remove('active'));

    // Aktiven Button hervorheben
    btn.classList.add('active');

    // Wert in verstecktem Input speichern
    const typ = btn.dataset.typ;
    typInput.value = typ;

    // Kategorie-Liste aktualisieren
    if (typ === "einnahme") {
      aktualisiereKategorien(einnahmeKategorien);
    } else {
      aktualisiereKategorien(ausgabeKategorien);
    }
  });
});

// Optional: Standard-Auswahl setzen, OHNE echten Klick (damit Popup geschlossen bleibt)
// ‚ùå Das √ºberschreibt deine korrekte Standard-Auswahl wieder zur√ºck auf "einnahme"
// if (typButtons.length > 0) {
//   typButtons.forEach(b => b.classList.remove('active'));
//   typButtons[0].classList.add('active');
//   popupTypInput.value = typButtons[0].dataset.typ;
//   aktualisiereKategorien(ausgabeKategorien);
// }

function berechneMonatsuebersicht(jahr, monat) {
  let einnahmen = 0;
  let ausgaben = 0;

  eintraege.forEach(eintrag => {
    const eintragsDatum = new Date(eintrag.datum);
    if (eintragsDatum.getFullYear() === jahr && eintragsDatum.getMonth() === monat) {
      if (eintrag.typ === "einnahme") {
        einnahmen += eintrag.betrag;
      } else if (eintrag.typ === "ausgabe") {
        ausgaben += eintrag.betrag;
      }
    }
  });

  // Budget aus localStorage holen
  const userBudgetText = localStorage.getItem('userBudget');
  const userBudget = parseFloat(userBudgetText) || 0;

  // Monatsbudget berechnen (Budget - Ausgaben)
  const monatlichesBudget = userBudget - ausgaben;

  // DOM aktualisieren
  document.getElementById("monat-einnahmen").textContent = einnahmen.toFixed(2) + " ‚Ç¨";
  document.getElementById("monat-ausgaben").textContent = ausgaben.toFixed(2) + " ‚Ç¨";
  document.getElementById("monat-budget").textContent = monatlichesBudget.toFixed(2) + " ‚Ç¨";

  // Optional: Saldo (Einnahmen - Ausgaben)
  const saldoElement = document.getElementById("monat-saldo");
  if (saldoElement) {
    const saldo = einnahmen - ausgaben;
    saldoElement.textContent = saldo.toFixed(2) + " ‚Ç¨";
    saldoElement.classList.remove("positiv", "negativ");
    saldoElement.classList.add(saldo >= 0 ? "positiv" : "negativ");
  }
  // Budget-Slider aktualisieren
  // Budget und Ausgaben als Prozent
  const ausgabenProzent = userBudget > 0 ? (ausgaben / userBudget) * 100 : 0;
  const fillElement = document.getElementById("budget-bar-fill");
  fillElement.style.width = Math.min(ausgabenProzent, 100) + "%";  // Max 100%
  // Zeitlicher Fortschritt im Monat
  const heute = new Date();
  const aktuellerTag = heute.getDate();
  const tageImMonat = new Date(jahr, monat + 1, 0).getDate();
  const zeitFortschrittProzent = (aktuellerTag / tageImMonat) * 100;

  const zeitMarker = document.getElementById("budget-time-marker");
  zeitMarker.style.left = `${Math.min(zeitFortschrittProzent, 100)}%`;

  // Dynamische Farbe je nach Ausgaben vs. Zeitfortschritt
  if (ausgabenProzent <= zeitFortschrittProzent) {
  fillElement.style.backgroundColor = "#a8e6a1"; // hellgr√ºn
  } else {
  fillElement.style.backgroundColor = "#f6a6a6"; // hellrot
  }



// Textanzeige aktualisieren wie viel % ausgegeben wurde vom Budget
// const textanzeige = document.getElementById("budget-stand-text");
// textanzeige.textContent = `${ausgaben.toFixed(2)}‚ÄØ‚Ç¨ von ${userBudget.toFixed(2)}‚ÄØ‚Ç¨ ausgegeben`;

}


// Budget-Verwaltungs Popup Start
// === Budget Popup Logik ===

// Elemente selektieren
const budgetOverlay = document.getElementById('budget-popup-overlay');
const openBudgetBtn = document.getElementById('open-budget-popup');
const closeBudgetBtn = document.getElementById('budget-close');
const saveBudgetBtn = document.getElementById('save-budget');
const clearBudgetBtn = document.getElementById('clear-budget');
const budgetInput = document.getElementById('budget-input');

// √ñffnet das Budget-Popup
if (openBudgetBtn) {
  openBudgetBtn.addEventListener('click', () => {
    const savedBudget = localStorage.getItem('userBudget');
    budgetInput.value = savedBudget || '';
    budgetOverlay.classList.remove('hidden');
  });
}

// Schlie√üt das Budget-Popup
if (closeBudgetBtn) {
  closeBudgetBtn.addEventListener('click', () => {
    budgetOverlay.classList.add('hidden');
  });
}
// Schlie√üt das Popup, wenn man au√üerhalb des Inhalts klickt
budgetOverlay.addEventListener('click', (e) => {
  if (e.target === budgetOverlay) {
    budgetOverlay.classList.add('hidden');
  }
});


// Budget speichern
saveBudgetBtn.addEventListener('click', () => {
  const value = budgetInput.value.trim();
  if (value && !isNaN(value) && Number(value) > 0) {
    localStorage.setItem('userBudget', value);
    alert(`Budget gespeichert: ${value} ‚Ç¨`);
    budgetOverlay.classList.add('hidden');

    // HIER: Monats√ºbersicht aktualisieren
    const heute = new Date();
    berechneMonatsuebersicht(heute.getFullYear(), heute.getMonth());
    berechneMonatsuebersicht(aktuellesDatum.getFullYear(), aktuellesDatum.getMonth());

  } else {
    alert('Bitte gib ein g√ºltiges Budget ein.');
  }
});


// Budget l√∂schen
if (clearBudgetBtn) {
  clearBudgetBtn.addEventListener('click', () => {
    budgetInput.value = '';
    localStorage.removeItem('userBudget');
    alert('Budget wurde gel√∂scht.');
  });
}
// Budget-Verwaltungs Popup Ende
</script>


<!-- Hilfsfunktion f√ºr Budget aktualisieren Ende -->

<style>
   body {
    font-family: Arial, sans-serif;
    max-width: 700px;
    margin: 1rem auto 5rem auto;
    padding: 0 1rem;
  }
  h1, h2 {
    text-align: center;
  }
  form {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    justify-content: center;
    margin-bottom: 1rem;
  }
  form > * {
    font-size: 1rem;
    padding: 0.3rem 0.5rem;
  }
  input[type=number] {
    width: 90px;
  }
  input[type=date] {
    width: 140px;
  }
  button {
    cursor: pointer;
    padding: 0.4rem 1rem;
    font-weight: bold;
  }
  #liste {
  list-style: none;
  padding: 0;
  /* max-height: 160px; */       /* Entfernen */
  /* overflow-y: auto; */        /* Entfernen */
  border: 1px solid #ddd;
  border-radius: 4px;
  margin-bottom: 2rem;
}
  #liste li {
    display: flex;
    justify-content: space-between;
    padding: 0.3rem 0.5rem;
    border-bottom: 1px solid #eee;
  }
  #liste li span {
    flex-grow: 1;
  }
  #liste li button {
    background: #e74c3c;
    border: none;
    color: white;
    font-weight: bold;
    border-radius: 3px;
    padding: 0 6px;
  }
  #liste li button:hover {
    background: #c0392b;
  }

  /* Kalender */
  #kalender {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 4px;
    margin-bottom: 2rem;
    user-select: none;
  }
  #kalender div.leer {
    background: #f9f9f9;
    border: none;
  }
  #kalender div.tag {
    border: 1px solid #ccc;
    min-height: 70px;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: center;
    padding: 4px 2px;
    cursor: pointer;
    border-radius: 4px;
    background: #fff;
    font-size: 0.9rem;
    position: relative;
    transition: background-color 0.2s;
  }
  #kalender div.tag:hover {
    background-color: #f0f8ff;
  }
  #kalender div.tag .saldo {
    font-weight: bold;
    margin-top: 4px;
    font-size: 0.85rem;
  }
  #kalender div.tag .saldo.positiv {
    color: green;
  }
  #kalender div.tag .saldo.negativ {
    color: red;
  }
  #kalender div.tag.heute {
    background-color: #fff3cd;
    border-color: #ffa500;
  }
  #kalender div.tag.ausgewaehlt {
    background-color: #d0ebff;
    border-color: #339af0;
  }
  #kalender div.tag.heute.ausgewaehlt {
    background-color: #d0ebff;
    border-color: #ffa500;
  }
  #monatsteuerelemente {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 1rem;
  margin: 1.5rem 0;
}

#monatsteuerelemente button {
  background-color: #007bff;
  color: white;
  border: none;
  padding: 0.5rem 1rem;
  border-radius: 8px;
  font-size: 1rem;
  cursor: pointer;
  transition: background-color 0.2s ease;
}

#monatsteuerelemente button:hover {
  background-color: #0056b3;
}

#monatanzeige {
  font-weight: bold;
  font-size: 1.5rem;
  background-color: #f0f0f0;
  padding: 0.6rem 1.2rem;
  border-radius: 10px;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
  user-select: none;
}


  /* Tab-Leiste unten */
    /* Tab-Leiste unten */

  /* Tab-Leiste unten */
  #tabs {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  display: flex;
  gap: 10px;
  z-index: 9999;
  background: #ffffff;
  padding: 10px;
  padding-bottom: 40px; /* Extra Platz unten */
  box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.2);
  border-radius: 12px 12px 0 0;
}
  #tabs button {
    flex: 1;
    padding: 10px 0;
    border: none;
    background: #e0e0e0;
    cursor: pointer;
    font-weight: bold;
    font-size: 1rem;
    transition: background-color 0.3s;
  }
  #tabs button:not(:last-child) {
    border-right: 1px solid #ccc;
  }
  #tabs button.active {
    background: #339af0;
    color: white;
  }
  #tabs button:hover:not(.active) {
    background: #cce4ff;
  }

  /* Tab-Inhalt */
  #tab-content > div {
    display: none;
  }
  #tab-content > div.active {
    display: block;
  }

/* Plus-Button unten rechts */
#plus-button {
  position: fixed;
  bottom: 110px;
  right: 20px;
  background: #339af0;
  color: white;
  border: none;
  border-radius: 50%;
  width: 56px;
  height: 56px;
  font-size: 2rem;
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  cursor: pointer;
  z-index: 1000;
}


/* Popup-Overlay */
/* Popup-Grundlayout */
#popup-overlay {
  display: none; /* ‚úÖ damit es anfangs versteckt ist */
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0, 0, 0, 0.5);
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

#popup {
  background-color: white;
  padding: 20px;
  border-radius: 10px;
  width: 300px;
  position: relative;
}

#popup-close {
  position: absolute;
  top: 10px;
  right: 10px;
  border: none;
  background: none;
  font-size: 24px;
  cursor: pointer;
}

/* Typ Buttons */
#typ-buttons {
  display: flex;
  gap: 10px;
  margin-bottom: 20px;
}

.typ-btn {
  flex: 1;
  padding: 12px 16px;
  font-size: 16px;
  font-weight: 500;
  border-radius: 8px;
  cursor: pointer;
  border: 2px solid transparent;
  background-color: #f8f9fa;
  transition: all 0.3s ease;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

/* Einzahlung (gr√ºn) */
.typ-btn[data-typ="einnahme"] {
  border-color: #28a745;
  color: #28a745;
}
.typ-btn[data-typ="einnahme"]:hover {
  background-color: rgba(40, 167, 69, 0.1);
}
.typ-btn[data-typ="einnahme"].active {
  background-color: #28a745;
  color: white;
}

/* Auszahlung (rot) */
.typ-btn[data-typ="ausgabe"] {
  border-color: #dc3545;
  color: #dc3545;
}
.typ-btn[data-typ="ausgabe"]:hover {
  background-color: rgba(220, 53, 69, 0.1);
}
.typ-btn[data-typ="ausgabe"].active {
  background-color: #dc3545;
  color: white;
}


table {
  width: 100%;
  margin-bottom: 10px;
}

select,
input[type="number"],
input[type="date"],
button[type="submit"] {
  width: 100%;
  padding: 8px;
  margin-top: 5px;
  box-sizing: border-box;
  border-radius: 5px;
  border: 1px solid #ccc;
}
/*Submit Button sch√∂n*/
button[type="submit"] {
  background-color: #28a745;
  color: white;
  border: none;
  margin-top: 15px;
  cursor: pointer;
}

button[type="submit"] {
  background-color: #2e86de; /* Prim√§r-Blau */
  color: white;
  border: none;
  margin-top: 15px;
  cursor: pointer;
  font-size: 16px;
  padding: 10px;
  border-radius: 6px;
  transition: background-color 0.3s ease;
}

button[type="submit"]:hover {
  background-color: #1e6fd9; /* etwas dunkler beim Hover */
}

/* Dynamische Kategorien */
#kategorie-verwalten {
  background: #f1f1f1;
  padding: 15px;
  border-radius: 10px;
  width: 300px;
}

#kategorie-verwalten h3 {
  margin-top: 0;
}

#kategorie-verwalten select,
#kategorie-verwalten input,
#kategorie-verwalten button {
  width: 100%;
  padding: 8px;
  margin-top: 8px;
  box-sizing: border-box;
  border-radius: 5px;
  border: 1px solid #ccc;
}

/*Popup fertig*/

/* Responsive Anpassungen f√ºr Smartphones */
@media (max-width: 480px) {
  body {
    padding: 0 0.5rem;
    margin-bottom: 7rem; /* Platz f√ºr fixe Tabs unten */
  }

  form {
    flex-direction: column;
    align-items: stretch;
  }

  input[type=number],
  input[type=date],
  select {
    width: 100% !important;
  }

  #tabs {
    width: 100%;
    border-radius: 0;
    left: 0;
    transform: none;
  }

  #tab-content-statistik canvas {
    width: 100% !important;
    height: auto !important;
  }

  #kalender {
    grid-template-columns: repeat(7, minmax(35px, 1fr));
  }

  #kalender div.tag {
    min-height: 60px;
    font-size: 0.8rem;
  }

  button,
  #monatsteuerelemente button {
    font-size: 0.9rem;
    padding: 0.5rem;
  }
}
/* Responsive Anpassungen f√ºr Smartphones fertig */


/* Formatierung der Monatsausgabenaussicht ganz oben auf der Titelseite */
#monatsuebersicht {
  position: fixed;
  top: 70px; /* Platz unter dem Header */
  left: 0;
  width: 100%;
  display: flex;
  justify-content: space-around;
  gap: 10px;
  margin: 0; /* Kein Margin bei fixed */
  padding: 15px;
  border-radius: 0;
  background-color: #f9f9f9;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
  font-weight: bold;
  flex-wrap: wrap;
  z-index: 999;
}

.uebersicht-feld {
  flex: 1;
  min-width: 100px;
  text-align: center;
  padding: 12px;
  border-radius: 10px;
  background-color: white;
  box-shadow: inset 0 0 3px rgba(0, 0, 0, 0.05);
  font-size: 1.1em;
}

.einnahmen span {
  color: #2e7d32; /* dunkles Gr√ºn */
  font-weight: bold;
}

.ausgaben span {
  color: #c62828; /* dunkles Rot */
  font-weight: bold;
}

.Budget span {
  font-weight: bold;
}

.Budget .positiv {
  color: #1565c0; /* blau */
}

.Budget .negativ {
  color: #c62828; /* rot */
}


/* Formatierung der Monatsausgabenaussicht ganz oben auf der Titelseite fertig */


/* Formatting Hamburger Zeichen - Einstellungszeichen Titelseite */
#header {
  position: relative;
  padding: 1rem 1.5rem;
  border-bottom: 1px solid #ddd;
}

#header h1 {
  margin: 0;
  font-size: 1.8rem;
  text-align: center;
}

#settings-icon {
  position: absolute;
  right: 1.5rem;
  top: 50%;
  transform: translateY(-50%);
  font-size: 1.8rem;
  cursor: pointer;
  user-select: none;
  padding: 0.2rem 0.5rem;
  border-radius: 6px;
  transition: background-color 0.2s;
}

#settings-icon:hover {
  background-color: #eee;
}

/* Formatting Hamburger Zeichen - Einstellungszeichen Titelseite fertig */

/* Popup2 - Einstellungen style */
#settings-icon {
        font-size: 2rem;
        cursor: pointer;
        user-select: none;
      }
      #popup2-overlay {
        display: none;
        position: fixed;
        top: 0; left: 0; right: 0; bottom: 0;
        background: rgba(0,0,0,0.5);
        justify-content: center;
        align-items: center;
        z-index: 1000;
      }
      #popup2 {
        background: white;
        padding: 20px;
        border-radius: 10px;
        max-width: 400px;
        width: 90%;
        position: relative;
      }
      #popup2-close {
        position: absolute;
        top: 10px; right: 10px;
        font-size: 1.5rem;
        cursor: pointer;
        border: none;
        background: transparent;
      }
/* Popup2 - Einstellungen - hamburger Zeichen style fertig*/

/* Tab2 - Slider Ein-Auszahlungen Gesamt */
.container-switch {
  width: 300px;
  margin: 20px auto 40px;
}

.nav {
  display: flex;
  justify-content: space-between;
  position: relative;
  border-bottom: 1px solid #ccc;
  user-select: none;
  height: 56px; /* feste H√∂he kann helfen */
}

.nav > div {
  flex: 1;
  text-align: center;
  padding: 16px 0;      /* Mehr H√∂he */
  cursor: pointer;
  font-weight: bold;    /* Fett */
  font-size: 1.1rem;    /* Optional: etwas gr√∂√üer */
}


.nav > div[data-pos]:hover {
  background-color: #f0f0f0;
}

.underline {
  position: absolute;
  bottom: 1px;
  height: 1px;
  width: 33.3333%;
  background-color: #007bff;
  transform: scaleY(0.2); /* halbiert visuell die Dicke */
  transform-origin: bottom;
  transition: left 0.3s ease;
}

/* Tab2 - Slider Ein-Auszahlungen Gesamt fertig */


/* Budget-Verwaltungs Popup Start */
/* Gemeinsames Overlay-Design */
.overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.6);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 999;
}

.hidden {
  display: none;
}

/* Popup Container */
.popup {
  background: #fff;
  padding: 30px;
  border-radius: 12px;
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
  width: 90%;
  max-width: 400px;
  text-align: center;
  position: relative;
}

/* Close Button */
.close-btn {
  position: absolute;
  top: 12px;
  right: 15px;
  font-size: 24px;
  border: none;
  background: none;
  cursor: pointer;
}

/* Eingabefeld */
#budget-input {
  width: 80%;
  padding: 10px;
  font-size: 18px;
  border: 1px solid #ccc;
  border-radius: 8px;
  margin-top: 15px;
}

/* Button-Gruppe */
.budget-buttons {
  margin-top: 20px;
  display: flex;
  gap: 10px;
  justify-content: center;
}

.budget-buttons button {
  padding: 10px 16px;
  font-size: 16px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  transition: 0.2s;
}

#save-budget {
  background-color: #28a745;
  color: white;
}

#clear-budget {
  background-color: #dc3545;
  color: white;
}

.budget-buttons button:hover {
  opacity: 0.9;
}
/* Budget-Verwaltungs Popup Ende */

/* Budget Slider Start */
#budget-progress-container {
  width: 100%;
  margin-top: 10px;
}

#budget-bar-background {
  position: relative;
  height: 20px;
  background-color: #eee;
  border-radius: 10px;
  overflow: hidden;
}

#budget-bar-fill {
  height: 100%;
  width: 0%;
  transition: width 0.5s ease-in-out, background-color 0.5s ease-in-out;
  background-color: #a8e6a1; /* Default: hellgr√ºn */
}


#budget-time-marker {
  position: absolute;
  top: 0;
  bottom: 0;
  width: 5px;
  background-color: rgb(0, 4, 255);
  z-index: 2;
  pointer-events: none;
}

/* Zweiter marker f√ºr wie weit sollte es sein */
#slider-wrapper {
  position: relative;
  width: 100%;
}

#budget-slider {
  width: 100%;
  height: 10px;
  appearance: none;
  background-color: #eee;
  border-radius: 5px;
  outline: none;
  position: relative;
  z-index: 1;
}

#budget-slider::-webkit-slider-thumb {
  appearance: none;
  width: 16px;
  height: 16px;
  background-color: #007BFF;
  border-radius: 50%;
  cursor: default;
}

#zeit-marker {
  position: absolute;
  top: -4px;
  bottom: -4px;
  width: 2px;
  background-color: rgb(0, 110, 255);
  z-index: 2;
  pointer-events: none;
  border-radius: 1px;
}



/* Budget Slider Ende */
</style>


<!-- wohl irgendetwas f√ºr offline -->
 <script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('service-worker.js');
  }
</script>

  <script src="script.js"></script>

</body>
</html>
